this.n??={A:4e3,B:5e3},
this.echoA??=Array(n.A).fill(0),
this.echoB??=Array(n.B).fill(0),
t||(
echoA=Array(n.A).fill(0),
echoB=Array(n.B).fill(0)
),

song=t=>(b=t>>19,
d=b%4!=1,
F=(x,y)=>x>>(t>>y)&1,
S=(a,t,s,p=1,v=0)=>2.1*(t+v)/p*2**(a[t>>s&(a.length-1)]/12)&128,
M=t=>t>0&&(b>5?.45:.6)*S([8,0,-7,5,0,-7,8,0,-7,5,0,-7,8,0,5,-7,10,0,-7,5,0,-11,10,1,-7,7,3,-2,10,3,-2,7,12,0,-7,8,0,-7,12,0,-7,8,0,-7,12,0,8,-7,12,0,-7,8,0,-7,12,0,10,1,3,7,-2,3,5,7,8,-4,-11,5,-4,-11,8,-4,-7,5,-4,-11,10,-4,5,-7,7,-2,-9,3,-2,-9,7,-2,-9,3,-9,-2,8,7,5,10,12,0,-7,8,0,-7,12,0,-7,8,0,-7,12,0,8,-7,12,0,-7,8,0,-7,12,0,10,1,3,7,-2,3,5,7],t,12)*(1-t%4096/4224/(d?1:1+(t>>16)%8/4)),
L=(t,p)=>.18*S([8,10,12,12,8,7,5,7,8,10,12,15,10,12,5,5],t,16,p,14*sin(t/1E3))*(b>5&&d?F(b+1&4?0x5555D555:0xD75D5755,11):.8),
N=p=>.3*(1E6*sin(t/1E2*p|0)&64),
(M(t)+(b>1&&d&&28*(sin(19*cbrt(t/4%2048))+1)*F(0xD555F555,13)+N(80)*F(0x51111111,10)/2+(t&8192&&N(99)*(1-t%8192/12E3)))+(b>2&&.16*S([5,5,7,3,5,5,5,3,1,1,3,3,-2,-2,-2,1],t,15,4)+(d&&N(19)*F(0xC4444444,13)))+(b>4&&L(t,.5)+.4*L(t-4096,.5)+L(t)/2)))*1.37,

[
	echoB[t%n.B]=
		(
			song(t/1.1)
			+
			echoA[t%n.A]
		)/2,

	echoA[t%n.A]=
		(
			song((t+sin(t/5e4)*32)/1.1)
			+
			echoB[t%n.B]
		)/2
]